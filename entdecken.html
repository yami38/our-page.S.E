<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Edin & Sudenaz ‚Äî Entdecken</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;padding:0;background:snow;font-family:Arial,Helvetica,sans-serif;color:#111}
  header{
    background:snow;
    font-family:'Great Vibes',cursive;
    color:#8b0000;
    display:flex;align-items:center;justify-content:center;gap:10px;
    padding:18px;position:fixed;top:0;left:0;width:100%;z-index:1000;border-bottom:1px solid #eee
  }
  header i{color:#8b0000}
  header a{color:#8b0000;text-decoration:none;font-family:'Great Vibes',cursive}
  main{padding:110px 16px 24px;min-height:calc(100vh - 110px);display:flex;flex-direction:column;align-items:center;gap:12px}
  #hud{font-size:1.05rem;display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
  #hud .pill{background:#fff;padding:6px 10px;border-radius:8px;box-shadow:0 3px 8px rgba(0,0,0,0.06);font-weight:600}
  .game-wrap{width:100%;max-width:760px;display:flex;flex-direction:column;align-items:center;gap:12px}
  canvas{background:linear-gradient(180deg,#fff6f6,#fff0f0);border-radius:12px;box-shadow:0 8px 26px rgba(0,0,0,0.08);touch-action:none;display:block;width:100%;height:auto}
  button{background:#8b0000;color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
  footer{margin-top:auto;padding:12px;text-align:center;background:transparent}
  @media(max-width:520px){ main{padding-top:100px} header{font-size:1.3rem;padding:12px} }
</style>
</head>
<body>

<header>
  <i class="fas fa-heart"></i>
  <a href="index.html">Edin & Sudenaz</a>
  <i class="fas fa-heart"></i>
</header>

<main>
  <div class="game-wrap">
    <h1 style="margin:0">Fang die Herzen ‚ù§Ô∏è</h1>

    <div id="hud">
      <div class="pill">Score: <span id="score">0</span></div>
      <div class="pill">Best: <span id="best">0</span></div>
      <div class="pill">Verpasst: <span id="missed">0</span>/5</div>
      <button id="restartBtn" style="display:none">üîÑ Neu starten</button>
    </div>

    <canvas id="gameCanvas" aria-label="Herzen Fang Spiel"></canvas>

    <div style="max-width:700px;color:#444;text-align:center">
      Tippe/klicke Herzen zum sofortigen Einsammeln. Bewege den Korb mit Maus, Touch (ziehen) oder Pfeiltasten.
    </div>
  </div>
</main>

<footer>
  <a href="entdecken.html">Entdecken</a> |
  <a href="einkaufen.html">Einkaufen</a> |
  <a href="kontaktieren.html">Kontaktieren</a>
</footer>

<script>
/* ---------- Config ---------- */
const CONFIG = {
  maxObjects: 5,            // 4-5 Objekte gleichzeitig
  baseSpawnMs: 1100,
  minSpawnMs: 300,
  spawnCurve: 10,         // wie stark spawn schneller wird pro Score
  baseFallSpeed: 1.6,
  speedIncreaseEvery: 8,
  missedLimit: 5
};

/* ---------- Canvas / Resize ---------- */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let width=300, height=400;
function resizeCanvas(){
  const maxW = 760;
  const w = Math.min(maxW, Math.max(320, window.innerWidth - 40));
  const h = Math.round(w * 0.8);
  canvas.width = w;
  canvas.height = h;
  width = canvas.width; height = canvas.height;
  // adjust basket size
  placeBasket();
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* ---------- State ---------- */
let basket = { x:0, y:0, width:70, height:18 };
function placeBasket(){
  basket.width = Math.max(48, Math.round(width * 0.14));
  basket.height = Math.max(12, Math.round(height * 0.035));
  basket.x = (width - basket.width)/2;
  basket.y = height - basket.height - 8;
}
placeBasket();

let objects = []; // {x,y,vy,type}
let score = 0;
let missed = 0;
let running = true;
let best = Number(localStorage.getItem('eds_best') || 0);
document.getElementById('best').textContent = best;

/* ---------- Types (weights sum to 1) ---------- */
const TYPES = [
  { id:'orange', emoji:'üß°', points:1, bad:false, weight:0.60 },
  { id:'red',    emoji:'‚ù§Ô∏è', points:2, bad:false, weight:0.25 },
  { id:'diamond',emoji:'üíé', points:5, bad:false, weight:0.05 },
  { id:'flip',   emoji:'üñï', points:-1, bad:true, weight:0.10 }
];

function pickType(){
  const r = Math.random();
  let acc=0;
  for(const t of TYPES){
    acc += t.weight;
    if(r <= acc) return t;
  }
  return TYPES[0];
}

/* ---------- Spawn / difficulty ---------- */
let spawnTimer = null;
function scheduleSpawn(){
  if(spawnTimer) clearTimeout(spawnTimer);
  // spawn interval decreases with score
  const next = Math.max(CONFIG.minSpawnMs, CONFIG.baseSpawnMs - score * CONFIG.spawnCurve);
  spawnTimer = setTimeout(()=>{
    if(running && objects.length < CONFIG.maxObjects) spawnOne();
    scheduleSpawn();
  }, next);
}
function spawnOne(){
  const t = pickType();
  const margin = Math.round(width*0.06);
  const x = Math.random() * (width - margin*2) + margin;
  const base = CONFIG.baseFallSpeed + Math.floor(score / CONFIG.speedIncreaseEvery) * 0.35;
  const vy = base + Math.random()*0.7;
  objects.push({ x, y: -30, vy, type: t });
}
scheduleSpawn();

/* ensure always ~maxObjects */
function maintainObjects(){
  while(running && objects.length < Math.min(CONFIG.maxObjects, 5)) spawnOne();
}

/* ---------- Input Handling ---------- */
let leftPressed=false, rightPressed=false;
document.addEventListener('keydown', e=>{
  if(e.key === 'ArrowLeft') leftPressed = true;
  if(e.key === 'ArrowRight') rightPressed = true;
});
document.addEventListener('keyup', e=>{
  if(e.key === 'ArrowLeft') leftPressed = false;
  if(e.key === 'ArrowRight') rightPressed = false;
});

// mouse move (desktop)
let mouseDown=false;
canvas.addEventListener('mousedown', ()=>mouseDown=true);
window.addEventListener('mouseup', ()=>mouseDown=false);
canvas.addEventListener('mousemove', e=>{
  if(mouseDown || e.buttons === 1){
    const r = canvas.getBoundingClientRect();
    const x = e.clientX - r.left;
    basket.x = Math.min(Math.max(0, x - basket.width/2), width - basket.width);
  } else {
    // optional: hover controls even without click
    const r = canvas.getBoundingClientRect();
    const x = e.clientX - r.left;
    basket.x = Math.min(Math.max(0, x - basket.width/2), width - basket.width);
  }
});

// touch drag (mobile) ‚Äî prevent page scroll
canvas.addEventListener('touchstart', e=>e.preventDefault(), {passive:false});
canvas.addEventListener('touchmove', e=>{
  e.preventDefault();
  const r = canvas.getBoundingClientRect();
  const x = e.touches[0].clientX - r.left;
  basket.x = Math.min(Math.max(0, x - basket.width/2), width - basket.width);
}, {passive:false});

// click/tap to collect object directly
canvas.addEventListener('click', e=>{
  const r = canvas.getBoundingClientRect();
  const x = e.clientX - r.left;
  const y = e.clientY - r.top;
  // check objects from top
  for(let i=objects.length-1;i>=0;i--){
    const o = objects[i];
    const dx = x - o.x, dy = y - o.y;
    if(Math.hypot(dx,dy) < Math.max(28, height*0.06)){
      collectObject(i);
      break;
    }
  }
});

/* ---------- Collect / Miss logic ---------- */
function collectObject(index){
  const o = objects[index];
  if(!o) return;
  score += o.type.points;
  // stinkefinger caught = penalty AND counts as missed
  if(o.type.bad){
    missed++;
  }
  if(score < 0) score = 0;
  updateHUD();
  // update best
  if(score > best){ best = score; localStorage.setItem('eds_best', String(best)); document.getElementById('best').textContent = best; }
  objects.splice(index,1);
}

function updateHUD(){
  document.getElementById('score').textContent = score;
  document.getElementById('missed').textContent = missed;
}

/* ---------- Game Over / Reset ---------- */
const restartBtn = document.getElementById('restartBtn');
restartBtn.addEventListener('click', resetGame);

function gameOver(){
  running = false;
  restartBtn.style.display = 'inline-block';
}

function resetGame(){
  objects = [];
  score = 0;
  missed = 0;
  running = true;
  restartBtn.style.display = 'none';
  updateHUD();
  scheduleSpawn();
}

/* ---------- Draw / Step ---------- */
function drawBasket(){
  ctx.fillStyle = '#ffb6c1';
  ctx.fillRect(Math.round(basket.x), Math.round(basket.y), basket.width, basket.height);
  // small shadow
  ctx.fillStyle = 'rgba(0,0,0,0.08)';
  ctx.fillRect(Math.round(basket.x)+6, basket.y + basket.height - 3, basket.width - 12, 3);
}

function drawObject(o){
  const emSize = Math.round(height*0.07);
  ctx.font = emSize + 'px serif';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  // circle background for clarity
  ctx.beginPath();
  ctx.fillStyle = (o.type.id === 'orange' ? '#ffe9da' : o.type.id === 'red' ? '#ffdfe7' : o.type.id === 'diamond' ? '#fff8e6' : '#f3f3f3');
  ctx.arc(o.x, o.y, Math.round(height*0.06), 0, Math.PI*2);
  ctx.fill();
  ctx.fillStyle = '#000';
  ctx.fillText(o.type.emoji, o.x, o.y + (height*0.005));
}

function step(){
  if(!running) { render(); return; }

  // keyboard control
  if(rightPressed) basket.x = Math.min(width - basket.width, basket.x + 6);
  if(leftPressed)  basket.x = Math.max(0, basket.x - 6);

  // physics
  for(let i = objects.length-1; i>=0; i--){
    const o = objects[i];
    o.y += o.vy;
    // horizontal wobble
    o.x += Math.sin((o.y + i*12)/40) * 0.6;

    // if fallen below
    if(o.y > height + 30){
      // if it's a good object and missed -> increment missed
      if(!o.type.bad){
        missed++;
        updateHUD();
        if(missed >= CONFIG.missedLimit){ gameOver(); }
      }
      objects.splice(i,1);
    } else {
      // collision with basket (caught by touching)
      if(o.y > basket.y && o.x > basket.x - 12 && o.x < basket.x + basket.width + 12){
        // catching stinkefinger penalizes
        if(o.type.bad){
          score = Math.max(0, score + o.type.points);
          missed++;
        } else {
          score += o.type.points;
        }
        if(score > best){ best = score; localStorage.setItem('eds_best', String(best)); document.getElementById('best').textContent = best; }
        updateHUD();
        objects.splice(i,1);
      }
    }
  }

  // ensure enough objects present
  maintainObjects();
  render();
  requestAnimationFrame(step);
}

function render(){
  ctx.clearRect(0,0,width,height);
  // bg
  const g = ctx.createLinearGradient(0,0,0,height);
  g.addColorStop(0,'#fff6f6'); g.addColorStop(1,'#fff0f0');
  ctx.fillStyle = g; ctx.fillRect(0,0,width,height);

  // draw objects
  for(const o of objects) drawObject(o);

  // draw basket
  drawBasket();
}

/* ---------- start ---------- */
function init(){
  resizeCanvas();
  placeBasket();
  objects = [];
  score = 0; missed=0; running=true;
  updateHUD();
  restartBtn.style.display = 'none';
  scheduleSpawn();
  requestAnimationFrame(step);
}
init();
</script>

</body>
</html>



